<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to GenomicBreaks • GenomicBreaks</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to GenomicBreaks">
<meta property="og:description" content="GenomicBreaks">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GenomicBreaks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/GenomicBreaks.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/StructuralVariants.html">Structural Variants</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oist/GenomicBreaks/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="GenomicBreaks_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to GenomicBreaks</h1>
                        <h4 class="author">Charlotte West</h4>
                        <h4 class="author">Charles Plessy</h4>
            
            <h4 class="date">21 October, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oist/GenomicBreaks/blob/master/vignettes/GenomicBreaks.Rmd"><code>vignettes/GenomicBreaks.Rmd</code></a></small>
      <div class="hidden name"><code>GenomicBreaks.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_knit.html">opts_knit</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <em>GenomicBreaks</em> R package contains tools for visualising and analysing characteristics associated with <em>breakpoints</em> between pairs of <em>genomes</em>.</p>
<div id="load-pacakges" class="section level2">
<h2 class="hasAnchor">
<a href="#load-pacakges" class="anchor"></a>Load pacakges</h2>
<p>Core packages that provide functions we use a lot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://oist.github.io/GenomicBreaks">'GenomicBreaks'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.org/packages/BSgenome">'BSgenome'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.org/packages/GenomicFeatures">'GenomicFeatures'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.org/packages/GenomicRanges">'GenomicRanges'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">'ggplot2'</a></span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>We will use yeast data as an example, so let’s load the <code>Scerevisiae</code> BSgenome package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"BSgenome.Scerevisiae.UCSC.sacCer3"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h2>
<p>This package contains an example data file representing the alignment of the <em>Saccharomyces paradoxus</em> genome version <code>ASM207905v1</code> to the <code>SacCer3</code> reference genome of <em>S. cerevisiae</em>. An alignment file was produced with a Nextflow <a href="https://github.com/oist/plessy_pairwiseGenomeComparison">pairwise alignment pipeline</a> and converted to <a href="https://github.com/The-Sequence-Ontology/Specifications/blob/master/gff3.md">GFF3</a> format with the <code>maf-convert gff -J 1000000</code> command of the <a href="https://gitlab.com/mcfrith/last/-/blob/main/doc/maf-convert.rst">LAST</a> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/SacCer3__SacPar.gff3.gz"</span>, package <span class="op">=</span> <span class="st">"GenomicBreaks"</span><span class="op">)</span>
<span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span><span class="va">exdata</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 590 ranges and 8 metadata columns:
##         seqnames          ranges strand |      source       type     score
##            &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;factor&gt;   &lt;factor&gt; &lt;numeric&gt;
##     [1]     chrM     58008-76168      + | maf-convert match             NA
##     [2]     chrM     58008-60967      + | maf-convert match_part     12243
##     [3]     chrM     61783-62447      + | maf-convert match_part      2557
##     [4]     chrM     63688-64744      + | maf-convert match_part      1520
##     [5]     chrM     66006-66345      + | maf-convert match_part      1159
##     ...      ...             ...    ... .         ...        ...       ...
##   [586]    chrIX   300905-301573      - | maf-convert match_part      1576
##   [587]    chrXV 1073474-1074872      - | maf-convert match             NA
##   [588]    chrXV 1073474-1074872      - | maf-convert match_part      3761
##   [589]   chrVII 1081381-1082672      - | maf-convert match             NA
##   [590]   chrVII 1081381-1082672      - | maf-convert match_part      4057
##             phase            ID                   Name                 Target
##         &lt;integer&gt;   &lt;character&gt;            &lt;character&gt;            &lt;character&gt;
##     [1]      &lt;NA&gt; NC_018044.1.1    NC_018044.1:1-16261                   &lt;NA&gt;
##     [2]      &lt;NA&gt;          &lt;NA&gt;     NC_018044.1:1-2820     NC_018044.1 1 2820
##     [3]      &lt;NA&gt;          &lt;NA&gt;  NC_018044.1:2834-3463  NC_018044.1 2834 3463
##     [4]      &lt;NA&gt;          &lt;NA&gt;  NC_018044.1:4786-5811  NC_018044.1 4786 5811
##     [5]      &lt;NA&gt;          &lt;NA&gt;  NC_018044.1:6743-7110  NC_018044.1 6743 7110
##     ...       ...           ...                    ...                    ...
##   [586]      &lt;NA&gt;          &lt;NA&gt; NC_047502.1:665227-6.. NC_047502.1 665227 6..
##   [587]      &lt;NA&gt; NC_047502.1.8  NC_047502.1:7842-9171                   &lt;NA&gt;
##   [588]      &lt;NA&gt;          &lt;NA&gt;  NC_047502.1:7842-9171  NC_047502.1 7842 9171
##   [589]      &lt;NA&gt; NC_047502.1.9  NC_047502.1:2001-3295                   &lt;NA&gt;
##   [590]      &lt;NA&gt;          &lt;NA&gt;  NC_047502.1:2001-3295  NC_047502.1 2001 3295
##                  Parent
##         &lt;CharacterList&gt;
##     [1]                
##     [2]   NC_018044.1.1
##     [3]   NC_018044.1.1
##     [4]   NC_018044.1.1
##     [5]   NC_018044.1.1
##     ...             ...
##   [586]   NC_047502.1.7
##   [587]                
##   [588]   NC_047502.1.8
##   [589]                
##   [590]   NC_047502.1.9
##   -------
##   seqinfo: 17 sequences from an unspecified genome; no seqlengths</code></pre>
</div>
</div>
<div id="gbreaks-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#gbreaks-objects" class="anchor"></a>GBreaks objects</h1>
<p>Pairwise genome alignments are loaded in <code><a href="../reference/GBreaks-class.html">GBreaks()</a></code> objects that wrap the <code>GRanges</code> class. By convention, we write that the <em>query</em> genome (the one that was provided as a FASTA file) is aligned to the <em>target</em> genome (the one that was indexed by the aligner). The <em>target</em> genome (on the left) is the main part of the object, and the <em>query</em> genome information (right) is contained in the metadata columns (<code>mcols</code>) of the structure. Information on contig or scaffold length is optionaly loaded from <code>BSgenome</code> objects, from which <code>seqinfo</code> data is extracted and passed to the <code>GRanges</code>. By convention, strand information of the alignment is held by the <em>target</em> <code>GRanges</code>, and the <em>query</em> <code>GRanges</code> are strandless. The objects are sorted by <code>seqname</code> first.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_genomic_breaks.html">load_genomic_breaks</a></span><span class="op">(</span><span class="va">exdata</span>, <span class="va">Scerevisiae</span><span class="op">)</span>
<span class="va">gb</span></code></pre></div>
<pre><code>## GBreaks object with 505 ranges and 2 metadata columns:
##         seqnames      ranges strand |     score                   query
##            &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;               &lt;GRanges&gt;
##     [1]     chrI  5860-10010      + |     10609  NC_047487.1:8723-12716
##     [2]     chrI 11157-11782      + |      1253 NC_047487.1:13035-13680
##     [3]     chrI 25371-26528      + |      3651 NC_047487.1:15380-16537
##     [4]     chrI 26849-29699      + |      6130 NC_047487.1:17263-20175
##     [5]     chrI 29937-30607      + |       767 NC_047487.1:20203-20866
##     ...      ...         ...    ... .       ...                     ...
##   [501]     chrM 67039-67870      + |      1441   NC_018044.1:7758-8439
##   [502]     chrM 68205-68580      + |       830   NC_018044.1:8783-9180
##   [503]     chrM 69178-76168      + |     14528  NC_018044.1:9650-16261
##   [504]     chrM 77356-80022      + |      8066 NC_018044.1:53206-55865
##   [505]     chrM 80919-85779      + |      6712 NC_018044.1:57885-61592
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gb</span><span class="op">$</span><span class="va">query</span></code></pre></div>
<pre><code>## GRanges object with 505 ranges and 0 metadata columns:
##            seqnames      ranges strand
##               &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt;
##     [1] NC_047487.1  8723-12716      *
##     [2] NC_047487.1 13035-13680      *
##     [3] NC_047487.1 15380-16537      *
##     [4] NC_047487.1 17263-20175      *
##     [5] NC_047487.1 20203-20866      *
##     ...         ...         ...    ...
##   [501] NC_018044.1   7758-8439      *
##   [502] NC_018044.1   8783-9180      *
##   [503] NC_018044.1  9650-16261      *
##   [504] NC_018044.1 53206-55865      *
##   [505] NC_018044.1 57885-61592      *
##   -------
##   seqinfo: 17 sequences from an unspecified genome; no seqlengths</code></pre>
<div id="maniuplation-of-gbreaks-objects-with-plyranges" class="section level2">
<h2 class="hasAnchor">
<a href="#maniuplation-of-gbreaks-objects-with-plyranges" class="anchor"></a>Maniuplation of GBreaks objects with plyranges</h2>
<p>With the <em>plyranges</em> package it is easy to manipulate <code>GBreaks</code> objects, in particular when filtering on features of the <em>query</em> genome.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Subset for chrI on the target genome.</span>
<span class="va">gb</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"chrI"</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 22 ranges and 2 metadata columns:
##        seqnames        ranges strand |     score                     query
##           &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;                 &lt;GRanges&gt;
##    [1]     chrI    5860-10010      + |     10609    NC_047487.1:8723-12716
##    [2]     chrI   11157-11782      + |      1253   NC_047487.1:13035-13680
##    [3]     chrI   25371-26528      + |      3651   NC_047487.1:15380-16537
##    [4]     chrI   26849-29699      + |      6130   NC_047487.1:17263-20175
##    [5]     chrI   29937-30607      + |       767   NC_047487.1:20203-20866
##    ...      ...           ...    ... .       ...                       ...
##   [18]     chrI 197472-198417      + |       644 NC_047487.1:187015-188000
##   [19]     chrI 198484-200975      + |      9880 NC_047487.1:192875-195376
##   [20]     chrI 200976-204211      + |     11801 NC_047487.1:195559-198812
##   [21]     chrI 205647-208058      + |      8709 NC_047494.1:515228-517518
##   [22]     chrI 224773-227362      + |     11047 NC_047487.1:224711-227317
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Subset for NC_047487.1 on the query genome</span>
<span class="va">gb</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">filter</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">==</span> <span class="st">"NC_047487.1"</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 24 ranges and 2 metadata columns:
##        seqnames        ranges strand |     score                     query
##           &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;                 &lt;GRanges&gt;
##    [1]     chrI    5860-10010      + |     10609    NC_047487.1:8723-12716
##    [2]     chrI   11157-11782      + |      1253   NC_047487.1:13035-13680
##    [3]     chrI   25371-26528      + |      3651   NC_047487.1:15380-16537
##    [4]     chrI   26849-29699      + |      6130   NC_047487.1:17263-20175
##    [5]     chrI   29937-30607      + |       767   NC_047487.1:20203-20866
##    ...      ...           ...    ... .       ...                       ...
##   [20]     chrI 200976-204211      + |     11801 NC_047487.1:195559-198812
##   [21]     chrI 224773-227362      + |     11047 NC_047487.1:224711-227317
##   [22]   chrVII 402974-403256      + |       730 NC_047487.1:179771-180020
##   [23]  chrVIII 527711-528802      + |      3617 NC_047487.1:202798-203906
##   [24]  chrVIII 530396-533532      + |      6424 NC_047487.1:205275-208524
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add or modify columns on the fly</span>
<span class="va">gb</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">mutate</a></span><span class="op">(</span><span class="st">"Width"</span> <span class="op">=</span> <span class="va">width</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 3 ranges and 3 metadata columns:
##       seqnames      ranges strand |     score                   query     Width
##          &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;               &lt;GRanges&gt; &lt;integer&gt;
##   [1]     chrI  5860-10010      + |     10609  NC_047487.1:8723-12716      4151
##   [2]     chrI 11157-11782      + |      1253 NC_047487.1:13035-13680       626
##   [3]     chrI 25371-26528      + |      3651 NC_047487.1:15380-16537      1158
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gb</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">mutate</a></span><span class="op">(</span><span class="st">"score"</span> <span class="op">=</span> <span class="va">width</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 3 ranges and 2 metadata columns:
##       seqnames      ranges strand |     score                   query
##          &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt;               &lt;GRanges&gt;
##   [1]     chrI  5860-10010      + |      4151  NC_047487.1:8723-12716
##   [2]     chrI 11157-11782      + |       626 NC_047487.1:13035-13680
##   [3]     chrI 25371-26528      + |      1158 NC_047487.1:15380-16537
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Etc…</span></code></pre></div>
<p>See the <a href="https://bioconductor.org/packages/release/bioc/vignettes/plyranges/inst/doc/an-introduction.html">vignette of <em>plyranges</em></a> for more details.</p>
</div>
<div id="breakpoints-and-alignment-stops" class="section level2">
<h2 class="hasAnchor">
<a href="#breakpoints-and-alignment-stops" class="anchor"></a>Breakpoints and alignment stops</h2>
<p>Let us define an <strong>alignment stop</strong> to be a position defined in either the <em>target</em> or <em>query</em> genome, where an alignment begins or ends. Looking at the first line in the <code>gb</code> object above, <code>ChrI</code> positions 5860 and 10010 of the <em>target</em> would be defined as alignment stops. Correspondingly, we have positions 8723 and 12176 in <code>NC_047487.1</code> of the <em>query</em> genome as alignment stops.</p>
<p>The function <code><a href="../reference/get_bps.html">get_bps()</a></code> takes in a <code>GBreaks</code> pairwise alignment or a simple <code>GRanges</code> object, and produces a <code>GRanges</code> object of it’s associated alignment stops. It has <code>direction</code>, <code>stranded</code> and <code>sorted</code> options to refind its output.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_bps.html">get_bps</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 3 ranges and 0 metadata columns:
##       seqnames    ranges strand
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
##   [1]     chrI      5860      *
##   [2]     chrI     10010      *
##   [3]     chrI     11157      *
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_bps.html">get_bps</a></span><span class="op">(</span><span class="va">gb</span>, direction <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 3 ranges and 0 metadata columns:
##       seqnames    ranges strand
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
##   [1]     chrI      5860      *
##   [2]     chrI     11157      *
##   [3]     chrI     25371      *
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_bps.html">get_bps</a></span><span class="op">(</span><span class="va">gb</span>,                      stranded <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 3 ranges and 0 metadata columns:
##       seqnames    ranges strand
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
##   [1]     chrI      5860      +
##   [2]     chrI     10010      -
##   [3]     chrI     11157      +
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_bps.html">get_bps</a></span><span class="op">(</span><span class="va">gb</span>,                      stranded <span class="op">=</span> <span class="cn">TRUE</span>, sorted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 3 ranges and 0 metadata columns:
##       seqnames    ranges strand
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
##   [1]     chrI      5860      +
##   [2]     chrI     11157      +
##   [3]     chrI     25371      +
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_bps.html">get_bps</a></span><span class="op">(</span><span class="va">gb</span>, direction <span class="op">=</span> <span class="st">"right"</span>, stranded <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 3 ranges and 0 metadata columns:
##       seqnames    ranges strand
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
##   [1]     chrI     10010      -
##   [2]     chrI     11782      -
##   [3]     chrI     26528      -
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_bps.html">get_bps</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span>, sorted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 3 ranges and 0 metadata columns:
##          seqnames    ranges strand
##             &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
##   [1] NC_047487.1      8723      *
##   [2] NC_047487.1     13035      *
##   [3] NC_047487.1     15380      *
##   -------
##   seqinfo: 17 sequences from an unspecified genome; no seqlengths</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_bps.html">get_bps</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## GRanges object with 3 ranges and 0 metadata columns:
##          seqnames    ranges strand
##             &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;
##   [1] NC_018044.1         1      *
##   [2] NC_018044.1      2820      *
##   [3] NC_018044.1      2834      *
##   -------
##   seqinfo: 17 sequences from an unspecified genome; no seqlengths</code></pre>
<p>Now, let us define a <strong>genomic breakpoint</strong> (or simply breakpoint) to be a genomic structural mutation, arising from breakage and repair of the chromosome. Such structural events include insertion, deletion, inversion and translocation, and often arise during recombination.</p>
<p>This package seeks to determine, of the group of alignment stops, which are likely genomic breakpoints and analyse them. Thus, filtering out alignment stops that are a result of bioinformatic errors.</p>
</div>
<div id="arms" class="section level2">
<h2 class="hasAnchor">
<a href="#arms" class="anchor"></a>Arms</h2>
<p>If the positions of the centromeres are known, an annotation file can be crafted to indicate the coordinates of the short and long arms, and the function <code><a href="../reference/flagLongShort.html">flagLongShort()</a></code> can be used to transfer this annotation to the <code>GBreaks</code> object.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html">GRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chrI:1-151465"</span>, <span class="st">"chrI:151582-230218"</span><span class="op">)</span><span class="op">)</span>
<span class="va">annot</span><span class="op">$</span><span class="va">Type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"short"</span>, <span class="st">"long"</span><span class="op">)</span>
<span class="fu"><a href="../reference/flagLongShort.html">flagLongShort</a></span><span class="op">(</span><span class="va">gb</span>, <span class="va">annot</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 505 ranges and 3 metadata columns:
##         seqnames      ranges strand |     score                   query
##            &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;               &lt;GRanges&gt;
##     [1]     chrI  5860-10010      + |     10609  NC_047487.1:8723-12716
##     [2]     chrI 11157-11782      + |      1253 NC_047487.1:13035-13680
##     [3]     chrI 25371-26528      + |      3651 NC_047487.1:15380-16537
##     [4]     chrI 26849-29699      + |      6130 NC_047487.1:17263-20175
##     [5]     chrI 29937-30607      + |       767 NC_047487.1:20203-20866
##     ...      ...         ...    ... .       ...                     ...
##   [501]     chrM 67039-67870      + |      1441   NC_018044.1:7758-8439
##   [502]     chrM 68205-68580      + |       830   NC_018044.1:8783-9180
##   [503]     chrM 69178-76168      + |     14528  NC_018044.1:9650-16261
##   [504]     chrM 77356-80022      + |      8066 NC_018044.1:53206-55865
##   [505]     chrM 80919-85779      + |      6712 NC_018044.1:57885-61592
##              Arm
##         &lt;factor&gt;
##     [1]    short
##     [2]    short
##     [3]    short
##     [4]    short
##     [5]    short
##     ...      ...
##   [501]       NA
##   [502]       NA
##   [503]       NA
##   [504]       NA
##   [505]       NA
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
</div>
<div id="measures-of-distance" class="section level2">
<h2 class="hasAnchor">
<a href="#measures-of-distance" class="anchor"></a>Measures of distance</h2>
<div id="synteny-index" class="section level3">
<h3 class="hasAnchor">
<a href="#synteny-index" class="anchor"></a>Synteny index</h3>
<p>Ad-hoc index measuring to what extent a scaffold of the <em>target</em> genome is mostly aligned to a single scaffold in the <em>query</em> genome. See <code><a href="../reference/synteny_index.html">?synteny_index</a></code> for details. One limitation to the use of this index is that it requires that at least the <em>query</em> genome is a complete chromosome assembly.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/synteny_index.html">synteny_index</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9954872</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/synteny_index.html">synteny_index</a></span><span class="op">(</span><span class="fu"><a href="../reference/swap.html">swap</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9954982</code></pre>
</div>
<div id="correlation" class="section level3">
<h3 class="hasAnchor">
<a href="#correlation" class="anchor"></a>Correlation</h3>
<p>Ad-hoc index measuring the correlation of the coordinates of the syntenic alignments in scaffolds of a <em>target</em> genome and their best match in the <em>query</em> genome. See <code><a href="../reference/correlation_index.html">?correlation_index</a></code> for details. This index is more robust to the presence of uncollapsed haplotypes in the <em>query</em> genome.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/correlation_index.html">correlation_index</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9942222</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/correlation_index.html">correlation_index</a></span><span class="op">(</span><span class="fu"><a href="../reference/swap.html">swap</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9946129</code></pre>
</div>
<div id="gene-order-conservation" class="section level3">
<h3 class="hasAnchor">
<a href="#gene-order-conservation" class="anchor"></a>Gene Order Conservation</h3>
<p>The <code><a href="../reference/GOC.html">GOC()</a></code> function calcluates the Gene Order Conservation number defined by Rocha (2003, <a href="https://doi.org/10.1016/j.tig.2003.09.011" class="uri">https://doi.org/10.1016/j.tig.2003.09.011</a>) as “<em>the average number of orthologues for which the consecutive orthologue co-occurs close by in the other genome. It varies between 0 (no co-occurrence) and 1 (complete gene order conservation)</em>”.</p>
<p><em>Note that calculating GOC on whole-genome alignments is not expected to produce meaningful results, and the example below is just to show that the computation is possible. This function is more useful when comparing the position of orthologues, represented in a <code>GBreaks</code> object.</em></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/GOC.html">GOC</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9227557</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/GOC.html">GOC</a></span><span class="op">(</span><span class="fu"><a href="../reference/swap.html">swap</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9123173</code></pre>
</div>
</div>
<div id="visualising-alignments" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-alignments" class="anchor"></a>Visualising alignments</h2>
<p>We can use the function <code>scaf_align_plot</code> to see the alignment of query scaffolds/chromosomes onto a specific target scaffold/chromosome of interest.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/scaf_align_plot.html">scaf_align_plot</a></span><span class="op">(</span><span class="va">gb</span>, scaf <span class="op">=</span> <span class="st">"chrI"</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Here we have plotted the alignments on the Okinawa genome (y-axis) onto the Osaka genome, scaffold 2 (x-axis). The coverage of the alignment is the bar along the top.</p>
<p>We can plot alignments for two of the target scaffolds side-by-side, using <code>align_scaf_plot-2</code>. This can be used in aid of superscaffolding.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/align_scaf_plot_2.html">align_scaf_plot_2</a></span><span class="op">(</span><span class="va">gb</span>, scaf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chrI"</span>,<span class="st">"chrII"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>As you can see, scaffold 2 of the query genome aligns to the majority of both target scaffolds. This could be used as evidence to support the superscaffolding of these two scaffolds - in an effort toward chromosomal assembly.</p>
</div>
<div id="coalescing-alignments" class="section level2">
<h2 class="hasAnchor">
<a href="#coalescing-alignments" class="anchor"></a>Coalescing alignments</h2>
<p>Large syntenic regions can often appear cluttered with alignment breaks, spanning just a few basepairs. They are either an artefact (for instance in case of incomplete purge of haplotypes) and or true breakpoint. The algorithm in <code>coalesce_contigs</code> is used to produce a new GRanges object with fewer alignment breaks by coalescing alignments separated by short (user specified) distances. This distance need be agreeable in both the target and query genome in order for the coalscion to happen.</p>
<p>For example, coalescing gaps of less than 500 basepairs in the <code>gb</code> alignment:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coalesce_contigs.html">coalesce_contigs</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 505</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 88</code></pre>
<p>The resulting <code>GBreaks</code> object has far fewer alignments and therefore far fewer alignment stops. The algorithm is an initial step in alignment stop filtering, with the goal of a reduced number of alignment stops that have a high probability of being breakpoints.</p>
</div>
<div id="genome-plots-with-genoplotr" class="section level2">
<h2 class="hasAnchor">
<a href="#genome-plots-with-genoplotr" class="anchor"></a>Genome plots with genoPlotR</h2>
<p>To visualise synteny it is clearer to plot from the coalseced objects.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotApairOfChrs.html">plotApairOfChrs</a></span><span class="op">(</span><span class="va">gb</span>,  <span class="st">"chrI"</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/test_genoPlotR-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotApairOfChrs.html">plotApairOfChrs</a></span><span class="op">(</span><span class="va">coa</span>, <span class="st">"chrI"</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/test_genoPlotR-2.png" width="700"></p>
</div>
<div id="trivial-translocations" class="section level2">
<h2 class="hasAnchor">
<a href="#trivial-translocations" class="anchor"></a>Trivial translocations</h2>
<div id="definitions" class="section level3">
<h3 class="hasAnchor">
<a href="#definitions" class="anchor"></a>Definitions</h3>
<p>Remember that we are working with one-to-one alignments. Therefore deletions, insertions and as a consequence copy number variations, are not in the aligned regions. Nevertheless, we can detect translocations from one chromosomal region to another. We define them by alignment pairs that interrupt the colinearity between two other pairs, and that are not inversions.</p>
</div>
<div id="representation" class="section level3">
<h3 class="hasAnchor">
<a href="#representation" class="anchor"></a>Representation</h3>
<p>The translocation below:</p>
<pre><code>┌──────────────┬──────────────┬──────────────┐
│ chrA:101-200 │ chrA:201-300 │ chrA:301-400 │ (Target genome)
└──────────────┴──────────────┴──────────────┘
      +               +             +         (Alignment direction)
┌──────────────┬──────────────┬──────────────┐
│ chrB:101-200 │ chrC:201-300 │ chrB:301-400 │ (Query genome)
└──────────────┴──────────────┴──────────────┘</code></pre>
<p>Is represented as:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exampleTranslocation</span></code></pre></div>
<pre><code>## GBreaks object with 3 ranges and 1 metadata column:
##       seqnames    ranges strand |        query
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;GRanges&gt;
##   [1]     chrA   100-200      + | chrB:100-200
##   [2]     chrA   201-300      + | chrC:201-300
##   [3]     chrA   301-400      + | chrB:301-400
##   -------
##   seqinfo: 1 sequence from an unspecified genome</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotApairOfChrs.html">plotApairOfChrs</a></span><span class="op">(</span><span class="va">exampleTranslocation</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/ideal_insertions-1.png" width="700"></p>
<p>See <code><a href="../articles/StructuralVariants.html">vignette("StructuralVariants", package = "GenomicBreaks")</a></code> for other examples of translocations.</p>
<p>Note also that <em>without an outgroup it is not possible to know in which genome the move happened</em>.</p>
</div>
<div id="detection" class="section level3">
<h3 class="hasAnchor">
<a href="#detection" class="anchor"></a>Detection</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/flagTranslocations.html">flagTranslocations</a></span><span class="op">(</span><span class="va">exampleTranslocation</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 3 ranges and 2 metadata columns:
##       seqnames    ranges strand |        query       tra
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;GRanges&gt; &lt;logical&gt;
##   [1]     chrA   100-200      + | chrB:100-200      TRUE
##   [2]     chrA   201-300      + | chrC:201-300     FALSE
##   [3]     chrA   301-400      + | chrB:301-400     FALSE
##   -------
##   seqinfo: 1 sequence from an unspecified genome</code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/showTranslocations.html">showTranslocations</a></span><span class="op">(</span><span class="fu"><a href="../reference/flagTranslocations.html">flagTranslocations</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 32 ranges and 3 metadata columns:
##      seqnames        ranges strand |                     query     score
##         &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |                 &lt;GRanges&gt; &lt;integer&gt;
##    1     chrI   5860-184523      + |   NC_047487.1:8723-169504    178664
##    2     chrI 184533-184781      + | NC_047487.1:176430-176696       249
##    3     chrI 185343-187499      + | NC_047487.1:170368-174401      2157
##    4     chrI 187502-189195      + | NC_047487.1:177293-179769      1694
##   12   chrIII 151968-168384      + | NC_047489.1:179584-195977     16417
##   ..      ...           ...    ... .                       ...       ...
##   64   chrXIV 777507-778973      - |   NC_047491.1:15022-16471      1467
##   65   chrXIV 778976-781047      + | NC_047500.1:768251-770345      2072
##   72    chrXV 855061-968849      + | NC_047501.1:832989-947263    113789
##   73    chrXV 969434-970268      - | NC_047501.1:953757-954546       835
##   74    chrXV 976413-980862      + | NC_047501.1:948879-953466      4450
##            tra
##      &lt;logical&gt;
##    1      TRUE
##    2      TRUE
##    3     FALSE
##    4     FALSE
##   12      TRUE
##   ..       ...
##   64     FALSE
##   65     FALSE
##   72      TRUE
##   73     FALSE
##   74     FALSE
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotApairOfChrs.html">plotApairOfChrs</a></span><span class="op">(</span><span class="va">coa</span>, chrT <span class="op">=</span> <span class="st">"chrI"</span>, xlim <span class="op">=</span> <span class="fu"><a href="../reference/gb2xlim.html">gb2xlim</a></span><span class="op">(</span><span class="va">coa</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/detect_trivial_insertions-1.png" width="700"></p>
</div>
</div>
<div id="trivial-inversions" class="section level2">
<h2 class="hasAnchor">
<a href="#trivial-inversions" class="anchor"></a>Trivial inversions</h2>
<p>See <code><a href="../articles/StructuralVariants.html">vignette("StructuralVariants", package = "GenomicBreaks")</a></code> for definitions.</p>
<div id="number-of-trivial-inversions" class="section level3">
<h3 class="hasAnchor">
<a href="#number-of-trivial-inversions" class="anchor"></a>Number of trivial inversions</h3>
<p>More inversions are found after coalescing colinear blocks because of situations where <code>+ - +</code> was <code>+ - - +</code> before collapsing.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/flagInversions.html">flagInversions</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 88 ranges and 3 metadata columns:
##        seqnames        ranges strand |                     query     score
##           &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |                 &lt;GRanges&gt; &lt;integer&gt;
##    [1]     chrI   5860-184523      + |   NC_047487.1:8723-169504    178664
##    [2]     chrI 184533-184781      + | NC_047487.1:176430-176696       249
##    [3]     chrI 185343-187499      + | NC_047487.1:170368-174401      2157
##    [4]     chrI 187502-189195      + | NC_047487.1:177293-179769      1694
##    [5]     chrI 189813-204211      + | NC_047487.1:180061-198812     14399
##    ...      ...           ...    ... .                       ...       ...
##   [84]     chrM     6313-9737      - |   NC_018044.1:62854-65728      3425
##   [85]     chrM   12828-50712      + |   NC_018044.1:22453-53190     37885
##   [86]     chrM   56625-57960      + |   NC_018044.1:70280-71345      1336
##   [87]     chrM   58008-76168      + |       NC_018044.1:1-16261     18161
##   [88]     chrM   77356-85779      + |   NC_018044.1:53206-61592      8424
##          inv
##        &lt;Rle&gt;
##    [1] FALSE
##    [2] FALSE
##    [3] FALSE
##    [4] FALSE
##    [5] FALSE
##    ...   ...
##   [84] FALSE
##   [85] FALSE
##   [86] FALSE
##   [87] FALSE
##   [88] FALSE
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/showInversions.html">showInversions</a></span><span class="op">(</span><span class="fu"><a href="../reference/flagInversions.html">flagInversions</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## GBreaks object with 12 ranges and 3 metadata columns:
##      seqnames         ranges strand |                      query     score
##         &lt;Rle&gt;      &lt;IRanges&gt;  &lt;Rle&gt; |                  &lt;GRanges&gt; &lt;integer&gt;
##   10   chrIII   11513-149405      + |   NC_047489.1:41910-177147    137893
##   11   chrIII  149866-151360      - |  NC_047489.1:178201-178974      1495
##   12   chrIII  151968-168384      + |  NC_047489.1:179584-195977     16417
##   34   chrVII   10270-110708      + |   NC_047493.1:11332-110230    100439
##   35   chrVII  112352-121552      - |  NC_047493.1:111748-121071      9201
##   ..      ...            ...    ... .                        ...       ...
##   39   chrVII  823466-828795      - |  NC_047493.1:792155-797486      5330
##   40   chrVII 828909-1076119      + | NC_047493.1:799044-1046538    247211
##   52     chrX   19114-354004      + |   NC_047496.1:12159-351096    334891
##   53     chrX  355632-374591      - |  NC_047496.1:353062-371883     18960
##   54     chrX  374938-727499      + |  NC_047496.1:373079-722743    352562
##        inv
##      &lt;Rle&gt;
##   10  TRUE
##   11 FALSE
##   12 FALSE
##   34  TRUE
##   35 FALSE
##   ..   ...
##   39 FALSE
##   40 FALSE
##   52  TRUE
##   53 FALSE
##   54 FALSE
##   -------
##   seqinfo: 17 sequences (1 circular) from sacCer3 genome</code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/showInversions.html">showInversions</a></span><span class="op">(</span><span class="fu"><a href="../reference/flagInversions.html">flagInversions</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>   |&gt; <span class="fu"><a href="../reference/plotApairOfChrs.html">plotApairOfChrs</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/detect_trivial_invertions-1.png" width="700"></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/showInversions.html">showInversions</a></span><span class="op">(</span><span class="fu"><a href="../reference/flagInversions.html">flagInversions</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">slice</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>   |&gt; <span class="fu"><a href="../reference/plotApairOfChrs.html">plotApairOfChrs</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/detect_trivial_invertions-2.png" width="700"></p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/showInversions.html">showInversions</a></span><span class="op">(</span><span class="fu"><a href="../reference/flagInversions.html">flagInversions</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">slice</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> |&gt; <span class="fu"><a href="../reference/plotApairOfChrs.html">plotApairOfChrs</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="GenomicBreaks_files/figure-html/detect_trivial_invertions-3.png" width="700"></p>
</div>
<div id="isolate-the-left-side-gaps-in-inversions" class="section level3">
<h3 class="hasAnchor">
<a href="#isolate-the-left-side-gaps-in-inversions" class="anchor"></a>Isolate the left-side gaps in inversions</h3>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># lgaps &lt;- function(reduced_gr) {</span>
<span class="co">#   # Flag inversions.</span>
<span class="co">#   #  WHAT FOLLOWS ASSUMES THAT THE FLAG IS ON THE LEFT-SIDE BLOCK OF THE TRIPLE</span>
<span class="co">#   lgaps &lt;- flagInversions(reduced_gr)</span>
<span class="co">#   # Extract inversions</span>
<span class="co">#   invs &lt;- lgaps[lgaps$inv]</span>
<span class="co">#   # Extend inversion of 1 bp so that they overlap with their neighbor gap</span>
<span class="co">#   invs &lt;- shift(invs, 1)</span>
<span class="co">#   # Remove strand information</span>
<span class="co">#   strand(lgaps) &lt;- "*"</span>
<span class="co">#   # Then extract gap positions ignoring strand</span>
<span class="co">#   lgaps &lt;- gaps(lgaps)</span>
<span class="co">#   # Remove bogus gaps on + and - strands</span>
<span class="co">#   lgaps &lt;- lgaps[strand(lgaps) == "*"] </span>
<span class="co">#   # Return the gaps overlapping with the flagged inversions</span>
<span class="co">#   subsetByOverlaps(lgaps, invs)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># # Using coa and not gbs for reason on better detection explained above.</span>
<span class="co"># inv.lgaps &lt;- sapply(coa, lgaps) |&gt; SimpleList()</span>
<span class="co"># </span>
<span class="co"># data.frame(width=width(inv.lgaps$Oki_Osa)) |&gt;</span>
<span class="co">#   ggplot(aes(width)) + geom_histogram() +  scale_x_log10()</span>
<span class="co"># </span>
<span class="co"># inv.lgaps.Seq &lt;- SimpleList()</span>
<span class="co"># </span>
<span class="co"># inv.lgaps.Seq$Oki_Osa &lt;- BSgenome::getSeq(OKI2018_I69,  inv.lgaps$Oki_Osa)</span>
<span class="co"># inv.lgaps.Seq$Oki_Kum &lt;- BSgenome::getSeq(OKI2018_I69,  inv.lgaps$Oki_Kum)</span>
<span class="co"># inv.lgaps.Seq$Osa_Oki &lt;- BSgenome::getSeq(OSKA2016v1.9, inv.lgaps$Osa_Oki)</span>
<span class="co"># inv.lgaps.Seq$Osa_Aom &lt;- BSgenome::getSeq(OSKA2016v1.9, inv.lgaps$Osa_Aom)</span>
<span class="co"># inv.lgaps.Seq$Oki_Bar &lt;- BSgenome::getSeq(OKI2018_I69,  inv.lgaps$Oki_Bar)</span>
<span class="co"># inv.lgaps.Seq$Bar_Oki &lt;- BSgenome::getSeq(Bar2_p4,      inv.lgaps$Bar_Oki)</span></code></pre></div>
</div>
</div>
<div id="tandem-repeats" class="section level2">
<h2 class="hasAnchor">
<a href="#tandem-repeats" class="anchor"></a>Tandem repeats</h2>
<p>Repeated regions of genomes are notoriously difficult to assemble and align. Thus, information about an alignment stop’s proximity to a tandem repeat is useful information in breakpoint classification. Given a user-defined tolerance, the function <code>tan_bp</code> will classify alignment stops as either far from, close to, or within tandem repeats (elements 1,2 and 3 of the produced list, respectively). The function requires the tandem repeat coverage of one of the genomes. By default, the function will expect the target genome tandem coverage. Setting <code>query_tf = TRUE</code> will switch the outcome to be query genome oriented.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># </span>
<span class="co"># tan_O &lt;- rtracklayer::import.gff3(system.file("extdata/OSKA2016.tantanf4w100.gff3.gz",  package="GenomicBreaks"))</span>
<span class="co"># tan_O &lt;- GRanges(tan_O, seqinfo = seqinfo(OSKA2016))</span>
<span class="co"># tan_gr_O &lt;- tan_bp(gr_ob = gr_O_Oki, tan = tan_O, tol = 50)</span>
<span class="co"># tan_gr_O</span>
<span class="co"># </span>
<span class="co"># tan_Oki &lt;- rtracklayer::import.gff3(system.file("extdata/I69-5.tantanf4w100.gff3.gz",  package="GenomicBreaks"))</span>
<span class="co"># tan_Oki &lt;- GRanges(tan_Oki, seqinfo = seqinfo(OKI2018_I69))</span>
<span class="co"># tan_gr_Oki &lt;- tan_bp(gr_ob = gr_O_Oki, tan = tan_Oki, tol = 50, query_tf = TRUE)</span>
<span class="co"># tan_gr_Oki</span></code></pre></div>
<p>We can use another script to plot the density of tandem repeats around alignment stops (and breakpoints). In the following plots, breakpoints are aligned at the centre of the plots. Intuitively, this function can be generalised to see the density of any binary coverage characteristic around breakpoints, given a GRanges object with per-base coverage of a given characteristic. Here we stick with tandem repeat info:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># hm_tan_O &lt;- gr_O_Oki %&gt;%</span>
<span class="co">#   feature_coverage(tan_O, win = 1000, lab = "Osaka ~ Okinawa", direction = "left") %&gt;%</span>
<span class="co">#   smoothHeatmap(output.size = c(2000,500), algorithm = "kernel") %T&gt;%</span>
<span class="co">#   plotHeatmap</span>
<span class="co"># </span>
<span class="co"># hm_red_tan_O &lt;- reduced_gr_O_Oki %&gt;%</span>
<span class="co">#   feature_coverage(tan_O, win = 1000, lab = "Osaka ~ Okinawa", direction = "left") %&gt;%</span>
<span class="co">#   smoothHeatmap(output.size = c(2000,500), algorithm = "kernel") %T&gt;%</span>
<span class="co">#   plotHeatmap</span>
<span class="co"># </span>
<span class="co"># hm_tan_Oki &lt;- gr_Oki_O %&gt;%</span>
<span class="co">#   feature_coverage(tan_Oki, win = 1000, lab = "Osaka ~ Okinawa", direction = "left") %&gt;%</span>
<span class="co">#   smoothHeatmap(output.size = c(2000,500), algorithm = "kernel") %T&gt;%</span>
<span class="co">#   plotHeatmapList</span></code></pre></div>
</div>
<div id="coverage" class="section level2">
<h2 class="hasAnchor">
<a href="#coverage" class="anchor"></a>Coverage</h2>
<p>Another characteristic of alignment stops that we can examine is the coverage depth over said alignment stops. By aligning raw reads to assembled genomes, we can obtain per-base coverage depth for target or query genome. Low coverage directly on and surrounding an alignment stop may suggest unreliability in it being a true breakpoint. The function <code>bp_coverage</code> returns a GRanges object of the bps, with associated averaged and point converage in the metadatacolumns.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># cov_gr_O_Oki &lt;- bp_coverage(gr_ob = q_Oki, cov_gr = Oki_cov_pb, win = 50)</span>
<span class="co"># cov_gr_O_Oki</span></code></pre></div>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="nucleaic-acid-content-heatmaps" class="section level2">
<h2 class="hasAnchor">
<a href="#nucleaic-acid-content-heatmaps" class="anchor"></a>Nucleaic acid content heatmaps</h2>
<p>The <em>GenomicBreaks</em> function <code>bp_heatmap</code> plots nucleic acid content in windows centrered on alignment stops. Lets look at <code>GC</code> content before and after coalescing:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(heatmaps)</span>
<span class="co"># hm_GC1 &lt;- sapply(gbs, bp_heatmap, basep_range = 1000, pat = "GC", direction = "left") |&gt; SimpleList()</span>
<span class="co"># hm_GC2 &lt;- sapply(coa, bp_heatmap, basep_range = 1000, pat = "GC", direction = "left") |&gt; SimpleList()</span>
<span class="co"># </span>
<span class="co"># maxHeight &lt;- 2000</span>
<span class="co"># sm_GC1 &lt;- sapply(hm_GC1, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># sm_GC2 &lt;- sapply(hm_GC2, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># sm_GC3 &lt;- sapply(hm_GC3, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># </span>
<span class="co"># plotHeatmapList(sm_GC1)</span>
<span class="co"># plotHeatmapList(sm_GC2)</span>
<span class="co"># plotHeatmapList(sm_GC3)</span></code></pre></div>
<p>The alignment stops are ordered in such a way that start (or left breaks) are centred on the top half of the plot, and end alignment stops are centred on the bottom. This is why we see different directionality in the plots. At the alignment stops, the GC content seems to be lower, but higher once within the aligned region.</p>
<p>Now looking at TATA content:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># hm_GC1_TATA &lt;- sapply(gbs, bp_heatmap, basep_range = 1000, pat = "TATA", direction = "left") |&gt; SimpleList()</span>
<span class="co"># hm_GC2_TATA &lt;- sapply(coa, bp_heatmap, basep_range = 1000, pat = "TATA", direction = "left") |&gt; SimpleList()</span>
<span class="co"># </span>
<span class="co"># maxHeight &lt;- 2000</span>
<span class="co"># sm_GC1_TATA &lt;- sapply(hm_GC1_TATA, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># sm_GC2_TATA &lt;- sapply(hm_GC2_TATA, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># sm_GC3_TATA &lt;- sapply(hm_GC3_TATA, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># </span>
<span class="co"># plotHeatmapList(sm_GC1_TATA)</span>
<span class="co"># plotHeatmapList(sm_GC2_TATA)</span>
<span class="co"># plotHeatmapList(sm_GC3_TATA)</span></code></pre></div>
<p>The directionaility here is consistent with the <code>GC</code> content analysis. Furthermore; “TATA box sequence can act as a basal promoter element not only for RNA polymerase II (RNAP II) transcription, but also for transcription by RNA polymerase III (RNAP III)” - Wang Y, Jensen RC, Stumph WE. Role of TATA box sequence and orientation in determining RNA polymerase II/III transcription specificity. Nucleic Acids Res. 1996;24(15):3100–3106. <a href="doi:10.1093/nar/24.15.3100" class="uri">doi:10.1093/nar/24.15.3100</a>. However, the areas are not particularly enriched for TATA boxes, so it does not necessarily show that breakpoints are occurring directly after promoter regions.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># hm_GC1_mot &lt;- sapply(gbs, bp_heatmap, basep_range = 1000, pat = "AGCNGC", direction = "left") |&gt; SimpleList()</span>
<span class="co"># hm_GC2_mot &lt;- sapply(coa, bp_heatmap, basep_range = 1000, pat = "AGCNGC", direction = "left") |&gt; SimpleList()</span>
<span class="co"># </span>
<span class="co"># maxHeight &lt;- 2000</span>
<span class="co"># sm_GC1_mot &lt;- sapply(hm_GC1_mot, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># sm_GC2_mot &lt;- sapply(hm_GC2_mot, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># sm_GC3_mot &lt;- sapply(hm_GC3_mot, smoothHeatmap, output.size = c(maxHeight,     500), algorithm = "kernel") |&gt; SimpleList()</span>
<span class="co"># </span>
<span class="co"># plotHeatmapList(sm_GC1_mot)</span>
<span class="co"># plotHeatmapList(sm_GC2_mot)</span>
<span class="co"># plotHeatmapList(sm_GC3_mot)</span></code></pre></div>
</div>
<div id="cluster-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#cluster-analysis" class="anchor"></a>Cluster analysis</h2>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># # Accessory functions</span>
<span class="co"># clusterHeatmap &lt;- function(hm, k = 2) kmeans(image(hm), k)</span>
<span class="co"># </span>
<span class="co"># orderHeatmap &lt;- function(hm, cl) {</span>
<span class="co">#   image(hm) &lt;- image(hm)[order(cl$cluster),]</span>
<span class="co">#   hm</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># subsetHeatmap &lt;- function(hm, bool) {</span>
<span class="co">#   image(hm) &lt;- image(hm)[bool,]</span>
<span class="co">#   hm</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># # DAta</span>
<span class="co"># hm_GC   &lt;- bp_heatmap(      gr_Oki_O, basep_range  = 1000, pat = "GC",     direction = "left")</span>
<span class="co"># hm_TATA &lt;- bp_heatmap(      gr_Oki_O, basep_range  = 1000, pat = "TATA",   direction = "left")</span>
<span class="co"># hm_tan  &lt;- feature_coverage(gr_Oki_O, tan_Oki, win = 1000, lab = "Tandem", direction = "left")</span>
<span class="co"># </span>
<span class="co"># # Define 3 K-mean clusters</span>
<span class="co"># clusterHeatmap(hm_GC, 3) -&gt; hm_cl_k4</span>
<span class="co"># </span>
<span class="co"># # Order and smooth</span>
<span class="co"># shm_GC &lt;- orderHeatmap(hm_GC, hm_cl_k4) %&gt;%</span>
<span class="co">#   smoothHeatmap(output.size = c(2000,500), algorithm = "kernel")</span>
<span class="co"># </span>
<span class="co"># shm_TATA &lt;- orderHeatmap(hm_TATA, hm_cl_k4) %&gt;%</span>
<span class="co">#   smoothHeatmap(output.size = c(2000,500), algorithm = "kernel")</span>
<span class="co"># </span>
<span class="co"># shm_tan &lt;- orderHeatmap(hm_tan, hm_cl_k4) %&gt;%</span>
<span class="co">#   smoothHeatmap(output.size = c(2000,500), algorithm = "kernel")</span>
<span class="co"># </span>
<span class="co"># # Plot the ordered data</span>
<span class="co"># plotHeatmapList(list(shm_GC, shm_TATA, shm_tan))</span>
<span class="co"># par(mfrow = c(1,1)) # plotHeatmapList messes with mrfrow...</span>
<span class="co"># plotHeatmapMeta(list(hm_GC, hm_TATA, hm_tan))</span>
<span class="co"># </span>
<span class="co"># plotHeatmapMeta(list(subsetHeatmap(hm_GC, hm_cl_k4$cluster == 1),</span>
<span class="co">#                      subsetHeatmap(hm_GC, hm_cl_k4$cluster == 2),</span>
<span class="co">#                      subsetHeatmap(hm_GC, hm_cl_k4$cluster == 3)))</span>
<span class="co"># </span>
<span class="co"># kmeanOrderedPlot &lt;- function (hm, k=3, seed = 1) {</span>
<span class="co">#   set.seed(seed)</span>
<span class="co">#   </span>
<span class="co">#   cl &lt;- kmeans(image(hm), k)</span>
<span class="co">#   mat &lt;- image(hm)[order(cl$cluster),]</span>
<span class="co">#   </span>
<span class="co">#   kmhm = Heatmap(</span>
<span class="co">#     mat,</span>
<span class="co">#     coords=c(-500,500),</span>
<span class="co">#     label="kmeans",</span>
<span class="co">#     scale=range(mat))</span>
<span class="co">#   </span>
<span class="co">#   plotHeatmapList(kmhm,</span>
<span class="co">#                   cex.label=1.5,</span>
<span class="co">#                   partition=as.vector(table(cl$cluster)),</span>
<span class="co">#                   partition.legend=TRUE,</span>
<span class="co">#                   partition.lines=TRUE,</span>
<span class="co">#                   legend=TRUE,</span>
<span class="co">#                   legend.pos="r",</span>
<span class="co">#                   legend.width=0.3)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># kmeanOrderedPlot(shm_GC)</span></code></pre></div>
</div>
<div id="evidence-for-breakpoint-hotspots" class="section level2">
<h2 class="hasAnchor">
<a href="#evidence-for-breakpoint-hotspots" class="anchor"></a>Evidence for breakpoint hotspots</h2>
<p>The function <code>bp_pair_analysis</code> takes two pairwise alignments with the same target genome, and plots the alignment stops on to the centred alignment stops of the other. In the plot below, Osaka is there consistent target genome, and as such acts as a coordinate system to relate alignment stops across genomes. Lets produce two of these 3-way analyses; one between Osaka-Okinawa-Norway, and one between Osaka-Okinawa-Aomori</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># hm1 &lt;- bp_pair_analysis(gr_ref_q1 = gr_O_Oki, gr_ref_q2 = gr_O_N, win = 1000, lab = "Oki~Nor")</span>
<span class="co"># plotHeatmapMeta(hm1)</span>
<span class="co"># </span>
<span class="co"># hm2 &lt;- bp_pair_analysis(gr_ref_q1 = gr_O_Oki, gr_ref_q2 = gr_O_A, win = 1000, lab = "Oki~Aom")</span>
<span class="co"># plotHeatmapMeta(hm2)</span></code></pre></div>
<p>The accumulation of alignment breaks of one pairwise alignment onto another suggests the existence of breakpoint hotspots; regions where breaks are far more likely to occur. Intuitively, this would lead to the presumption of synteny blocks, also. The pattern is consistent after coalescing, too;</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># reduced_gr_O_N &lt;- coalesce_contigs(gr_ob = gr_O_N, tol = 500)</span>
<span class="co"># </span>
<span class="co"># hm3 &lt;- bp_pair_analysis(gr_ref_q1 = reduced_gr_O_Oki, gr_ref_q2 = reduced_gr_O_N, win = 1000, lab = "Oki~Nor")</span>
<span class="co"># plotHeatmapMeta(hm3)</span></code></pre></div>
</div>
<div id="tandem-repeat-coverage-around-alignment-stops-breakpoints" class="section level2">
<h2 class="hasAnchor">
<a href="#tandem-repeat-coverage-around-alignment-stops-breakpoints" class="anchor"></a>Tandem repeat coverage around alignment stops (breakpoints)</h2>
<p>The function <code>feature_coverage</code> will plot the coverage of tandem repeats around centred alignment stops.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># </span>
<span class="co"># hm_tan1 &lt;- feature_coverage(gr_ob = gr_O_Oki, feat = tan_O, win = 4000, lab = "Osk ~ Oki", direction = "left")</span>
<span class="co"># plotHeatmapMeta(hm_tan1)</span>
<span class="co">#  </span>
<span class="co"># hm_tan2 &lt;- feature_coverage(gr_ob = reduced_gr_O_Oki, feat = tan_O, win = 4000, lab = "OSK~Oki (coalesced)", direction = "left")</span>
<span class="co"># plotHeatmapMeta(hm_tan2)</span>
<span class="co"># </span>
<span class="co"># # should I also add comparison of proportions of tandem proximities before and after coalescion?</span></code></pre></div>
<p>There appears to be less tandem repeats around alignment stops after coalescion, inferring that perhaps that some are artefacts of difficult alignment near to tandem repeats.</p>
</div>
<div id="gene-feature-coverage-around-alignment-stops-breakpoints" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-feature-coverage-around-alignment-stops-breakpoints" class="anchor"></a>Gene feature coverage around alignment stops (breakpoints)</h2>
<p>The function <code>feature_coverage</code> will plot the coverage of tandem repeats around centred alignment stops.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># #current_GB &lt;- gr_Oki_O # To ease recomputing with another object</span>
<span class="co"># current_GB &lt;- reduced_gr_Oki_O</span>
<span class="co"># hmList_OKI &lt;- list()</span>
<span class="co"># </span>
<span class="co"># hmList_OKI$genes      &lt;- feature_coverage(current_GB, genes(tx_OKI),                         win = 2000, lab = "Oki genes", direction = "left")</span>
<span class="co"># hmList_OKI$promoters  &lt;- feature_coverage(current_GB, promoters(tx_OKI),                     win = 2000, lab = "Oki promoters", direction = "left")</span>
<span class="co"># hmList_OKI$exons      &lt;- feature_coverage(current_GB, exonicParts(tx_OKI),                   win = 2000, lab = "Oki exons", direction = "left")</span>
<span class="co"># hmList_OKI$introns    &lt;- feature_coverage(current_GB, intronicParts(tx_OKI),                 win = 2000, lab = "Oki introns", direction = "left")</span>
<span class="co"># hmList_OKI$cds        &lt;- feature_coverage(current_GB, cds(tx_OKI),                           win = 2000, lab = "Oki cds", direction = "left")</span>
<span class="co"># hmList_OKI$utrs5      &lt;- feature_coverage(current_GB, unlist(fiveUTRsByTranscript(tx_OKI)),  win = 2000, lab = "Oki 5′ UTRs", direction = "left")</span>
<span class="co"># hmList_OKI$utrs3      &lt;- feature_coverage(current_GB, unlist(threeUTRsByTranscript(tx_OKI)), win = 2000, lab = "Oki 3′ UTRs", direction = "left")</span>
<span class="co"># hmList_OKI$pwm        &lt;- feature_coverage(current_GB, pwmHits                              , win = 2000, lab = "PWM", direction = "left")</span>
<span class="co"># </span>
<span class="co"># plotHeatmapMeta(hmList_OKI)</span>
<span class="co"># plotHeatmapMeta(hmList_OKI$genes)</span>
<span class="co"># plotHeatmapMeta(hmList_OKI[c("exons", "cds")])</span>
<span class="co"># plotHeatmapMeta(hmList_OKI[c("exons", "introns", "utrs5", "utrs3", "pwm")])</span>
<span class="co"># plotHeatmapMeta(hmList_OKI[c("introns", "utrs5", "utrs3", "pwm")])</span>
<span class="co"># plotHeatmapMeta(hmList_OKI[c("utrs5", "utrs3", "pwm")])</span></code></pre></div>
<p>Aligned regions are enriched in exons and depleted in introns. Is it because exons are more alignable or is it because it is deleterous to break genes in exons ?</p>
</div>
<div id="gene-feature-coverage-around-pwm-hits" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-feature-coverage-around-pwm-hits" class="anchor"></a>Gene feature coverage around PWM hits</h2>
<p>Let’s look at coverage around PWM hits of the AAGCsGCwwmkCGrCTTyn motif</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># current_GB &lt;- pwmHits</span>
<span class="co"># </span>
<span class="co"># hmList_PWM_OKI &lt;- list()</span>
<span class="co"># hmList_PWM_OKI$genes     &lt;- feature_coverage(current_GB, genes(tx_OKI),                         win = 2000, lab = "Oki genes", direction = "left")</span>
<span class="co"># hmList_PWM_OKI$promoters &lt;- feature_coverage(current_GB, promoters(tx_OKI),                     win = 2000, lab = "Oki promoters", direction = "left")</span>
<span class="co"># hmList_PWM_OKI$exons     &lt;- feature_coverage(current_GB, exonicParts(tx_OKI),                   win = 2000, lab = "Oki exons", direction = "left")</span>
<span class="co"># hmList_PWM_OKI$introns   &lt;- feature_coverage(current_GB, intronicParts(tx_OKI),                 win = 2000, lab = "Oki introns", direction = "left")</span>
<span class="co"># hmList_PWM_OKI$cds       &lt;- feature_coverage(current_GB, cds(tx_OKI),                           win = 2000, lab = "Oki cds", direction = "left")</span>
<span class="co"># hmList_PWM_OKI$utrs5     &lt;- feature_coverage(current_GB, unlist(fiveUTRsByTranscript(tx_OKI)),  win = 2000, lab = "Oki 5′ UTRs", direction = "left")</span>
<span class="co"># hmList_PWM_OKI$utrs3     &lt;- feature_coverage(current_GB, unlist(threeUTRsByTranscript(tx_OKI)), win = 2000, lab = "Oki 3′ UTRs", direction = "left")</span>
<span class="co"># </span>
<span class="co"># plotHeatmapMeta(hmList_PWM_OKI)</span>
<span class="co"># plotHeatmapMeta(hmList_PWM_OKI[c("exons", "introns")])</span>
<span class="co"># plotHeatmapMeta(hmList_PWM_OKI[c("exons", "utrs5", "utrs3")])</span>
<span class="co"># plotHeatmapMeta(hmList_PWM_OKI[c("utrs5", "utrs3")])</span></code></pre></div>
<p>They are enriched in introns…</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># </span>
<span class="co"># # Sandbox to make sanity checks.</span>
<span class="co"># </span>
<span class="co"># a &lt;- reduced_gr_Oki_O</span>
<span class="co"># b &lt;- unlist(fiveUTRsByTranscript(tx_OKI))</span>
<span class="co"># </span>
<span class="co"># hm_a &lt;- feature_coverage(a, b, win = 2000, lab = "All ranges", direction = "left")</span>
<span class="co"># hm_b &lt;- feature_coverage(subsetByOverlaps(a,  b), b, win = 2000, lab = "Subsetted ranges", direction = "left")</span>
<span class="co"># </span>
<span class="co"># plotHeatmapMeta(list(hm_a))</span>
<span class="co"># plotHeatmapMeta(list(hm_b))</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Charlotte West, Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
