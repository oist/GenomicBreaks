<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Flag colinear alignments — flagColinearAlignments • GenomicBreaks</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Flag colinear alignments — flagColinearAlignments" />
<meta property="og:description" content="Flags alignments that are colinear with the next one in sequence order.
The flag is added to the first alignment.  Colinearity is defined by the fact
that the next alignment on the target genome is the same as the next
alignment on the query genome, with strand information being taken into
account." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GenomicBreaks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/GenomicBreaks_vignette.html">Introduction to GenomicBreaks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/oist/GenomicBreaks/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Flag colinear alignments</h1>
    <small class="dont-index">Source: <a href='https://github.com/oist/GenomicBreaks/blob/master/R/flagColinearAlignments.R'><code>R/flagColinearAlignments.R</code></a></small>
    <div class="hidden name"><code>flagColinearAlignments.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Flags alignments that are colinear with the next one in sequence order.
The flag is added to the first alignment.  Colinearity is defined by the fact
that the next alignment on the <em>target</em> genome is the same as the next
alignment on the <em>query</em> genome, with strand information being taken into
account.</p>
    </div>

    <pre class="usage"><span class='fu'>flagColinearAlignments</span><span class='op'>(</span><span class='va'>gb</span>, tol <span class='op'>=</span> <span class='cn'>Inf</span>, minwidth <span class='op'>=</span> <span class='fl'>0</span>, details <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gb</th>
      <td><p><code><a href='GBreaks-class.html'>GBreaks</a></code> object of the pairwise alignment.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Unaligned regions larger than this <em>tolerance</em> threshold will
interrupt colinearity.</p></td>
    </tr>
    <tr>
      <th>minwidth</th>
      <td><p>Remove the intervals whose width smaller than this value.</p></td>
    </tr>
    <tr>
      <th>details</th>
      <td><p>Returns more metadata columns if <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a modified <code>GBreaks</code> object with a new <code>colinear</code> metadata
column indicating if an alignment is colinear with the next one.  If the
<code>details</code> option is set to <code>TRUE</code>, it will also output the relative position
of the following and previous alignments on the <em>target</em> and <em>query</em> genomes
(<code>tfoll</code>, <code>tprev</code>, <code>qfoll</code>, <code>qprev</code>), a partial colinearity flag for each
genome (<code>t_col</code> and <code>q_col</code>), and the distance to the next alignment on
each genome (<code>tdist</code> and <code>qdist</code>).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Internally, <code>flagColinearAlignments()</code> uses the <code>precede</code>
and <code>follow</code> functions functions to determine what is the
<em>next</em>.  For a given range, these functions return the index position of the
range it precedes or follows, or <code>NA</code> as the first range follows nothing and
the last range precedes nothing.  See the examples for details.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The flags are only valid as long as the Genomic Breaks object is not
modified by removing alignments or sorting them in a different order.</p>
<p>Pay attention that if the <code>mindwidth</code> option is passed, some intervals
are discarded from the returned object.  This parameter might be removed in
the future if too confusing or useless.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Flagging functions: 
<code><a href='flagAll.html'>flagAll</a>()</code>,
<code><a href='flagInsersions.html'>flagInsersions</a>()</code>,
<code><a href='flagInterruptions.html'>flagInterruptions</a>()</code>,
<code><a href='flagInversions.html'>flagInversions</a>()</code></p>
<p>Other Colinearity functions: 
<code><a href='GOC.html'>GOC</a>()</code>,
<code><a href='chain_contigs.html'>chain_contigs</a>()</code>,
<code><a href='coalesce_contigs.html'>coalesce_contigs</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Charlotte West</p>
<p>Charles Plessy</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Ranges on the plus strand that should coalesce</span>
<span class='va'>gb1</span>       <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>A<span class='op'>=</span><span class='st'>"Ref:100-200:+"</span>, B<span class='op'>=</span><span class='st'>"Ref:400-500:+"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gb1</span><span class='op'>$</span><span class='va'>query</span> <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>A<span class='op'>=</span><span class='st'>"Que:100-200"</span>,   B<span class='op'>=</span><span class='st'>"Que:400-500"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gb1</span>
</div><div class='output co'>#&gt; GRanges object with 2 ranges and 1 metadata column:
#&gt;     seqnames    ranges strand |       query
#&gt;        &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;GRanges&gt;
#&gt;   A      Ref   100-200      + | Que:100-200
#&gt;   B      Ref   400-500      + | Que:400-500
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'><span class='fu'>flagColinearAlignments</span><span class='op'>(</span><span class='va'>gb1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; GRanges object with 2 ranges and 2 metadata columns:
#&gt;     seqnames    ranges strand |       query colinear
#&gt;        &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;GRanges&gt;    &lt;Rle&gt;
#&gt;   A      Ref   100-200      + | Que:100-200     TRUE
#&gt;   B      Ref   400-500      + | Que:400-500    FALSE
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'>
<span class='co'># Reference range [1] precedes reference range [2]</span>
<span class='fu'>precede</span><span class='op'>(</span><span class='va'>gb1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  2 NA</div><div class='input'><span class='co'># Query range [1] precedes query range [2]</span>
<span class='fu'>precede</span><span class='op'>(</span><span class='va'>gb1</span><span class='op'>$</span><span class='va'>query</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  2 NA</div><div class='input'>
<span class='co'># Ranges on the minus strand that should coalesce</span>
<span class='va'>gb2</span>       <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>B<span class='op'>=</span><span class='st'>"Ref:100-200:-"</span>, A<span class='op'>=</span><span class='st'>"Ref:400-500:-"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gb2</span><span class='op'>$</span><span class='va'>query</span> <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>B<span class='op'>=</span><span class='st'>"Que:400-500"</span>,   A<span class='op'>=</span><span class='st'>"Que:100-200"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gb2</span><span class='op'>$</span><span class='va'>qname</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gb2</span><span class='op'>$</span><span class='va'>query</span><span class='op'>)</span>
<span class='va'>gb2</span>
</div><div class='output co'>#&gt; GRanges object with 2 ranges and 2 metadata columns:
#&gt;     seqnames    ranges strand |       query       qname
#&gt;        &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;GRanges&gt; &lt;character&gt;
#&gt;   B      Ref   100-200      - | Que:400-500           B
#&gt;   A      Ref   400-500      - | Que:100-200           A
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'><span class='co'># Reference range [1] follows reference range [2]</span>
<span class='fu'>follow</span><span class='op'>(</span><span class='va'>gb2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  2 NA</div><div class='input'><span class='co'># Or, ignoring strand, reference range [1] precedes reference range [2]</span>
<span class='fu'>precede</span><span class='op'>(</span><span class='va'>gb2</span>, ignore.strand <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  2 NA</div><div class='input'><span class='co'># Query range [1] follows query range [2]</span>
<span class='fu'>follow</span><span class='op'>(</span><span class='va'>gb2</span><span class='op'>$</span><span class='va'>query</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  2 NA</div><div class='input'><span class='fu'>flagColinearAlignments</span><span class='op'>(</span><span class='va'>gb2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; GRanges object with 2 ranges and 3 metadata columns:
#&gt;     seqnames    ranges strand |       query       qname colinear
#&gt;        &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;GRanges&gt; &lt;character&gt;    &lt;Rle&gt;
#&gt;   B      Ref   100-200      - | Que:400-500           B     TRUE
#&gt;   A      Ref   400-500      - | Que:100-200           A    FALSE
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'>
<span class='co'># Ranges on the minus strand that should not coalesce because they are not</span>
<span class='co'># ordered properly</span>
<span class='va'>gb3</span>       <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Ref:100-200:-"</span>, <span class='st'>"Ref:400-500:-"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gb3</span><span class='op'>$</span><span class='va'>query</span> <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Que:100-200"</span>,   <span class='st'>"Que:400-500"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Reference range [1] follows reference range [2]</span>
<span class='fu'>follow</span><span class='op'>(</span><span class='va'>gb3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  2 NA</div><div class='input'><span class='co'># Query range [1] follows query range [2]</span>
<span class='fu'>precede</span><span class='op'>(</span><span class='va'>gb3</span><span class='op'>$</span><span class='va'>query</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  2 NA</div><div class='input'><span class='fu'>flagColinearAlignments</span><span class='op'>(</span><span class='va'>gb3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; GRanges object with 2 ranges and 2 metadata columns:
#&gt;       seqnames    ranges strand |       query colinear
#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;GRanges&gt;    &lt;Rle&gt;
#&gt;   [1]      Ref   100-200      - | Que:100-200    FALSE
#&gt;   [2]      Ref   400-500      - | Que:400-500    FALSE
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'>
<span class='co'># Ranges on the plus strand that should not coalesce because they are not</span>
<span class='co'># ordered properly</span>
<span class='va'>gb4</span>       <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Ref:100-200:+"</span>, <span class='st'>"Ref:400-500:+"</span>, <span class='st'>"Ref:600-700:+"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gb4</span><span class='op'>$</span><span class='va'>query</span> <span class='op'>&lt;-</span> <span class='fu'>GRanges</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Que:1100-1200:+"</span>, <span class='st'>"Que:1700-1800:+"</span>, <span class='st'>"Que:1500-1600:+"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>flagColinearAlignments</span><span class='op'>(</span><span class='va'>gb4</span><span class='op'>)</span>
</div><div class='output co'>#&gt; GRanges object with 3 ranges and 2 metadata columns:
#&gt;       seqnames    ranges strand |           query colinear
#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; |       &lt;GRanges&gt;    &lt;Rle&gt;
#&gt;   [1]      Ref   100-200      + | Que:1100-1200:+    FALSE
#&gt;   [2]      Ref   400-500      + | Que:1700-1800:+    FALSE
#&gt;   [3]      Ref   600-700      + | Que:1500-1600:+    FALSE
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Charlotte West, Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


