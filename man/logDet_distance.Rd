% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/logDet_distance.R
\name{logDet_distance}
\alias{logDet_distance}
\title{LogDet (log-determinant) distance}
\usage{
logDet_distance(m, pseudocount = 0)
}
\arguments{
\item{m}{A numeric matrix of pairwise counts with row/column names including
\code{A,C,G,T}. If \code{m} is a list, the field \code{$probability_matrix}
is used (compatible with your other helpers).}

\item{pseudocount}{A non-negative number added to each A/C/G/T cell before
normalization (default \code{0}). Use a small value (e.g. \code{0.5}) to
reduce the chance of a singular matrix when some joint cells are zero. \href{https://www.megasoftware.net/web_help_11/logDet_distance_Could_Not_Be_Computed.htm}{2}}
}
\value{
A single numeric: the LogDet distance (substitutions/site, unitless).
Returns \code{Inf} if any required determinant/sign is non‑positive.

A single numeric: the HKY85 distance (substitutions/site).
}
\description{
Computes the LogDet (a.k.a. log-determinant) nucleotide distance between two
sequences from a 4×4 A/C/G/T joint count table. The method normalizes the
joint frequency matrix by the marginal base compositions of the two sequences
and then applies the log-determinant transform.
}
\details{
Let \eqn{M} be the 4×4 \strong{joint count} matrix over \code{A,C,G,T} and
\eqn{F = M / \sum M} the \strong{joint frequency} (divergence) matrix. Let
\eqn{\boldsymbol{r} = F \mathbf{1}} (row sums, seq1 base frequencies) and
\eqn{\boldsymbol{c} = F^\top \mathbf{1}} (column sums, seq2 base frequencies).
Define diagonal matrices \eqn{D_R = \mathrm{diag}(\boldsymbol{r})} and
\eqn{D_C = \mathrm{diag}(\boldsymbol{c})}. The \strong{LogDet} normalization uses
\deqn{
S \;=\; D_R^{-1/2}\, F \, D_C^{-1/2},
}
and the \strong{distance} is
\deqn{
d_{\mathrm{LogDet}} \;=\; -\,\ln \!\big( \det S \big)
\;=\; -\,\ln \!\big( \det F \big) \;+\; \tfrac{1}{2}\,\big[ \ln \!\big( \det D_R \big)
\;+\; \ln \!\big( \det D_C \big) \big].
}
This formulation follows the LogDet/paralinear family where determinants
commute (real scalars), enabling robustness to composition heterogeneity; see
Lockhart et al. (1994) for the transform and discussion, and MEGA’s note on
non-computability when log terms approach zero. \href{https://evoluscope.fr/phylographe/biblio/Lockhartetal1994.pdf}{1}\href{https://www.megasoftware.net/web_help_11/logDet_distance_Could_Not_Be_Computed.htm}{2}
}
\examples{
logDet_distance(exampleSubstitutionMatrix)

}
\references{
Lockhart PJ, Steel MA, Hendy MD, Penny D (1994). Recovering evolutionary
trees under a more realistic model of sequence evolution. \emph{Mol Biol Evol}
\strong{11}:605–612. \url{https://evoluscope.fr/phylographe/biblio/Lockhartetal1994.pdf} \href{https://evoluscope.fr/phylographe/biblio/Lockhartetal1994.pdf}{1}

MEGA help: “LogDet Distance Could Not Be Computed” (notes on log terms).
\url{https://www.megasoftware.net/web_help_11/logDet_distance_Could_Not_Be_Computed.htm} \href{https://www.megasoftware.net/web_help_11/logDet_distance_Could_Not_Be_Computed.htm}{2}

Gu X, Li WH (1996). Bias-corrected paralinear and LogDet distances and
tests under nonstationary nucleotide frequencies. \emph{Mol Biol Evol} \strong{13}:1375–1383.
\url{https://paperity.org/p/54207439/bias-corrected-paralinear-and-logdet-distances-and-tests-of-molecular-clocks-and} \href{https://paperity.org/p/54207439/bias-corrected-paralinear-and-logdet-distances-and-tests-of-molecular-clocks-and}{3}
}
\seealso{
Other Alignment statistics: 
\code{\link{F81_distance}()},
\code{\link{GCequilibrium}()},
\code{\link{GCpressure}()},
\code{\link{GCproportion}()},
\code{\link{HKY85_distance}()},
\code{\link{JC69_distance}()},
\code{\link{K80_distance}()},
\code{\link{P_distance}()},
\code{\link{T92_distance}()},
\code{\link{TN93_distance}()},
\code{\link{exampleSubstitutionMatrix}},
\code{\link{gapProportion}()}

Other Similarity indexes: 
\code{\link{F81_distance}()},
\code{\link{GOC}()},
\code{\link{HKY85_distance}()},
\code{\link{JC69_distance}()},
\code{\link{K80_distance}()},
\code{\link{P_distance}()},
\code{\link{T92_distance}()},
\code{\link{TN93_distance}()},
\code{\link{correlation_index}()},
\code{\link{karyotype_index}()},
\code{\link{slidingWindow}()},
\code{\link{strand_randomisation_index}()},
\code{\link{synteny_index}()},
\code{\link{tau_index}()}
}
\concept{Alignment statistics}
\concept{Similarity indexes}
