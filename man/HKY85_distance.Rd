% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HKY85_distance.R
\name{HKY85_distance}
\alias{HKY85_distance}
\title{Hasegawa–Kishino–Yano (1985) distance (HKY85)}
\usage{
HKY85_distance(m)
}
\arguments{
\item{m}{A numeric matrix of pair counts with row/column names including
\code{A,C,G,T}. If \code{m} is a list, the field \code{$probability_matrix}
is used (for compatibility with your other helpers).}
}
\value{
A single numeric: the HKY85 distance (substitutions/site).
}
\description{
Computes the HKY85 nucleotide substitution distance between two sequences,
using only the A/C/G/T block of a pairwise count matrix. Base frequencies
are estimated as the average of row and column marginals, and transitions
are pooled into a single class (A↔G and C↔T).
}
\details{
Let \eqn{P} be the total fraction of \strong{transition} differences
(A↔G \strong{plus} C↔T) among A/C/G/T pairs, and \eqn{Q} the fraction of
\strong{transversion} differences (all other A↔{C,T}, G↔{C,T} pairs).
Let \eqn{\pi_A,\pi_C,\pi_G,\pi_T} be the \strong{average base frequencies}
across the two sequences (row and column marginals averaged),
\eqn{\pi_R = \pi_A + \pi_G}, and \eqn{\pi_Y = \pi_C + \pi_T}.

The HKY85 distance (special case of TN93 with a single transition rate) is:
\deqn{
d_{\mathrm{HKY85}} =
  -\,2(\pi_A \pi_G + \pi_C \pi_T)\;
     \ln\!\left(1 - \frac{P}{2(\pi_A \pi_G + \pi_C \pi_T)}\right)
  -\,2\,\pi_R \pi_Y\;
     \ln\!\left(1 - \frac{Q}{2\,\pi_R \pi_Y}\right).
}

Implementation notes:
\itemize{
\item Rows/columns outside \code{A,C,G,T} are dropped.
\item \eqn{P} and \eqn{Q} are computed from the normalized 4×4 table.
\item \eqn{\pi_\bullet} are estimated as the average of row and column marginals.
\item Returns \code{Inf} if any log argument is non‑positive or a denominator is zero.
}
}
\examples{
HKY85_distance(exampleSubstitutionMatrix)

}
\references{
Hasegawa, M., Kishino, H., and Yano, T. (1985). Dating of the human–ape
splitting by a molecular clock of mitochondrial DNA. \emph{J. Mol. Evol.} 22:160–174.

RevBayes tutorial (overview of HKY, parameters \eqn{\kappa,\pi}):
\url{https://revbayes.github.io/tutorials/ctmc/}

IQ‑TREE model manual (relationships among HKY, K80, TN93):
\url{https://iqtree.github.io/doc/Substitution-Models}
}
\seealso{
Other Alignment statistics: 
\code{\link{F81_distance}()},
\code{\link{GCequilibrium}()},
\code{\link{GCpressure}()},
\code{\link{GCproportion}()},
\code{\link{JC69_distance}()},
\code{\link{K80_distance}()},
\code{\link{P_distance}()},
\code{\link{T92_distance}()},
\code{\link{TN93_distance}()},
\code{\link{exampleSubstitutionMatrix}},
\code{\link{gapProportion}()}

Other Similarity indexes: 
\code{\link{F81_distance}()},
\code{\link{GOC}()},
\code{\link{JC69_distance}()},
\code{\link{K80_distance}()},
\code{\link{P_distance}()},
\code{\link{T92_distance}()},
\code{\link{TN93_distance}()},
\code{\link{correlation_index}()},
\code{\link{karyotype_index}()},
\code{\link{slidingWindow}()},
\code{\link{strand_randomisation_index}()},
\code{\link{synteny_index}()},
\code{\link{tau_index}()}
}
\author{
Entirely written by Copilot and not proofchecked yet
}
\concept{Alignment statistics}
\concept{Similarity indexes}
